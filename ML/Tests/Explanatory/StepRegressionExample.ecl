	 IMPORT ML;
	 
   value_record := RECORD
   UNSIGNED rid;
   UNSIGNED X_1;
   REAL X_2;
	 REAL X_3;
	 REAL X_4;
	 REAL X_5;
	 REAL X_6;
   REAL Y;
   END;
   d := DATASET([{1,5,10.753,3.8275,-5.1651,-0.45723,-65.361,87.567},
		{2,10,36.678,-6.8827,-19.267,15.106,21.841,373.17},
		{3,15,-45.177,4.0883,23.064,133.31,-40.738,973.73},
		{4,20,17.243,9.2923,-40.117,-49.066,-16.075,-118.86},
		{5,25,6.3753,2.7867,-2.6924,-93.59,26.534,-464.71},
		{6,30,-26.154,5.8978,-34.765,-20.478,49.876,-2.7761},
		{7,35,-8.6718,4.1432,-50.289,98.854,-53.647,1048.2},
		{8,40,6.8525,-1.7296,-102.31,31.401,60.512,646.22},
		{9,45,71.568,1.6751,18.648,24.04,31.687,926.5},
		{10,50,55.389,-4.4875,-9.8814,51.891,-3.2575,1110.7},
		{11,55,-26.998,5.0639,-40.726,-47.105,-9.3706,14.341},
		{12,60,60.698,-6.5383,-40.349,3.173,-10.445,839.86},
		{13,65,14.508,-6.0926,27.714,3.4263,-14.549,678.47},
		{14,70,-1.2611,-4.6141,19.585,-18.101,1.1062,493.09},
		{15,75,14.295,-16.782,42.063,27.109,2.4619,942.08},
		{16,80,-4.0993,8.1988,109.88,-4.0917,39.651,674.38},
		{17,85,-2.4829,1.8536,-462.52,6.3303,73.295,806.71},
		{18,90,29.794,-4.3031,2.7143,16.88,22.412,1079.5},
		{19,95,28.181,7.8107,-100.44,7.2777,-10.066,1045.3},
		{20,100,28.344,-9.7556,-6.0129,-34.527,30.009,769.99}],value_record);
   	ML.ToField(d,o);
	X := O(Number IN [1, 2, 3, 4, 5, 6]); // Pull out the X
  Y := O(Number = 7); // Pull out the Y
	
	vars := DATASET([{1},{2},{4}], {UNSIGNED4 number});
	
	modelf := ML.StepRegression.ForwardRegression(X, Y);
	modelb := ML.StepRegression.BackwardRegression(X, Y);
	modelbi := ML.StepRegression.BidirecRegression(X, Y, vars);
	
	OUTPUT(modelf.Steps, NAMED('ForwardSteps'));
	OUTPUT(modelf.BestModel.betas, NAMED('ForwardBestBetas'));
	OUTPUT(modelb.Steps, NAMED('BackwardSteps'));
	OUTPUT(modelb.BestModel.betas, NAMED('BackwardBestBetas'));
	OUTPUT(modelbi.Steps, NAMED('BidirecSteps'));
	OUTPUT(modelbi.BestModel.betas, NAMED('BidirecBestBetas'));

/* R :
Code :
B <- matrix(c(5,10.753,3.8275,-5.1651,-0.45723,-65.361,87.567,
10,36.678,-6.8827,-19.267,15.106,21.841,373.17,
15,-45.177,4.0883,23.064,133.31,-40.738,973.73,
20,17.243,9.2923,-40.117,-49.066,-16.075,-118.86,
25,6.3753,2.7867,-2.6924,-93.59,26.534,-464.71,
30,-26.154,5.8978,-34.765,-20.478,49.876,-2.7761,
35,-8.6718,4.1432,-50.289,98.854,-53.647,1048.2,
40,6.8525,-1.7296,-102.31,31.401,60.512,646.22,
45,71.568,1.6751,18.648,24.04,31.687,926.5,
50,55.389,-4.4875,-9.8814,51.891,-3.2575,1110.7,
55,-26.998,5.0639,-40.726,-47.105,-9.3706,14.341,
60,60.698,-6.5383,-40.349,3.173,-10.445,839.86,
65,14.508,-6.0926,27.714,3.4263,-14.549,678.47,
70,-1.2611,-4.6141,19.585,-18.101,1.1062,493.09,
75,14.295,-16.782,42.063,27.109,2.4619,942.08,
80,-4.0993,8.1988,109.88,-4.0917,39.651,674.38,
85,-2.4829,1.8536,-462.52,6.3303,73.295,806.71,
90,29.794,-4.3031,2.7143,16.88,22.412,1079.5,
95,28.181,7.8107,-100.44,7.2777,-10.066,1045.3,
100,28.344,-9.7556,-6.0129,-34.527,30.009,769.99
),nrow = 20, ncol = 7, byrow=TRUE);

Y <- B[, 7];
X1 <- B[, 1];
X2 <- B[, 2];
X3 <- B[, 3];
X4 <- B[, 4];
X5 <- B[, 5];
X6 <- B[, 6];

Code :
modelf <- step(lm(Y ~ 1), direction="forward", scope=(~X1+X2+X3+X4+X5+X6));

Output :
Start:  AIC=246.51
Y ~ 1

       Df Sum of Sq     RSS    AIC
+ X5    1   2174039 1904029 233.28
+ X1    1   1094784 2983285 242.26
+ X3    1    515942 3562126 245.80
+ X2    1    407424 3670645 246.40
<none>              4078069 246.51
+ X4    1     17137 4060932 248.42
+ X6    1      7146 4070922 248.47

Step:  AIC=233.28
Y ~ X5

       Df Sum of Sq     RSS    AIC
+ X1    1   1579324  324706 199.90
+ X2    1    621696 1282333 227.37
+ X3    1    358683 1545347 231.10
+ X6    1    190611 1713418 233.16
<none>              1904029 233.28
+ X4    1     22470 1881559 235.04

Step:  AIC=199.9
Y ~ X5 + X1

       Df Sum of Sq    RSS     AIC
+ X2    1    324270    436  69.631
+ X3    1     42690 282015 199.080
<none>              324706 199.899
+ X4    1      4584 320121 201.614
+ X6    1       121 324584 201.891

Step:  AIC=69.63
Y ~ X5 + X1 + X2

       Df Sum of Sq    RSS    AIC
+ X3    1    72.025 363.81 68.018
<none>              435.84 69.631
+ X6    1    39.848 395.99 69.713
+ X4    1     0.640 435.20 71.601

Step:  AIC=68.02
Y ~ X5 + X1 + X2 + X3

       Df Sum of Sq    RSS    AIC
+ X6    1    44.010 319.80 67.439
<none>              363.81 68.018
+ X4    1     0.632 363.18 69.983

Step:  AIC=67.44
Y ~ X5 + X1 + X2 + X3 + X6

       Df Sum of Sq    RSS    AIC
<none>              319.80 67.439
+ X4    1    12.382 307.42 68.650

Code :
modelb <- step(lm(Y ~ X1+X2+X3+X4+X5+X6), direction="backward");

Output :
Start:  AIC=68.65
Y ~ X1 + X2 + X3 + X4 + X5 + X6

       Df Sum of Sq     RSS     AIC
- X4    1        12     320  67.439
<none>                  307  68.650
- X6    1        56     363  69.983
- X3    1        86     394  71.588
- X2    1    280989  281296 203.029
- X1    1   1054288 1054595 229.459
- X5    1   2393379 2393687 245.852

Step:  AIC=67.44
Y ~ X1 + X2 + X3 + X5 + X6

       Df Sum of Sq     RSS     AIC
<none>                  320  67.439
- X6    1        44     364  68.018
- X3    1        76     396  69.713
- X2    1    281685  282005 201.079
- X1    1   1069444 1069763 227.744
- X5    1   2452606 2452926 244.341

Code :
modelbi <- step(lm(Y ~ X1+X2+X4), direction="both", scope=(~X1+X2+X3+X4+X5+X6));

Output :
Start:  AIC=244.88
Y ~ X1 + X2 + X4

       Df Sum of Sq     RSS     AIC
+ X5    1   2784781     435  71.601
- X4    1        12 2785228 242.882
- X2    1    195536 2980752 244.239
+ X6    1    296698 2488518 244.629
<none>              2785216 244.882
+ X3    1     79122 2706094 246.306
- X1    1    851265 3636481 248.216

Step:  AIC=71.6
Y ~ X1 + X2 + X4 + X5

       Df Sum of Sq     RSS     AIC
- X4    1         1     436  69.631
+ X3    1        72     363  69.983
+ X6    1        42     394  71.588
<none>                  435  71.601
- X2    1    319686  320121 201.614
- X1    1   1234438 1234873 228.615
- X5    1   2784781 2785216 244.882

Step:  AIC=69.63
Y ~ X1 + X2 + X5

       Df Sum of Sq     RSS     AIC
+ X3    1        72     364  68.018
<none>                  436  69.631
+ X6    1        40     396  69.713
+ X4    1         1     435  71.601
- X2    1    324270  324706 199.899
- X1    1   1281897 1282333 227.369
- X5    1   2784792 2785228 242.882

Step:  AIC=68.02
Y ~ X1 + X2 + X5 + X3

       Df Sum of Sq     RSS     AIC
+ X6    1        44     320  67.439
<none>                  364  68.018
- X3    1        72     436  69.631
+ X4    1         1     363  69.983
- X2    1    281652  282015 199.080
- X1    1   1190271 1190635 227.885
- X5    1   2708747 2709111 244.328

Step:  AIC=67.44
Y ~ X1 + X2 + X5 + X3 + X6

       Df Sum of Sq     RSS     AIC
<none>                  320  67.439
- X6    1        44     364  68.018
+ X4    1        12     307  68.650
- X3    1        76     396  69.713
- X2    1    281685  282005 201.079
- X1    1   1069444 1069763 227.744
- X5    1   2452606 2452926 244.341
*/
	